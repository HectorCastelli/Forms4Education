<!DOCTYPE html>
<html>
  <head>
    <link
      rel="stylesheet"
      href="https://ssl.gstatic.com/docs/script/css/add-ons.css"
    />
    <style>
      .formItem > label {
        display:inline-block;
        text-align: right;
        width: 8em;
      }
    </style>
  </head>
  <body>
    <form id="formId">
      <div class="formItem">
        <label for="testName"><?= getLocalizedText("insertName") ?></label>
        <input type="text" name="testName" id="testName" />
      </div>
      <div class="formItem">
        <label for="testName"><?= getLocalizedText("startDate") ?></label>
        <input type="datetime-local" name="startDate" id="startDate" min="<?= new Date().toISOString() ?>"/>
      </div>
      <div class="formItem">
        <label for="testName"><?= getLocalizedText("endDate") ?></label>
        <input type="datetime-local" name="endDate" id="endDate"  min="<?= new Date().toISOString() ?>"/>
      </div>
      <div>
        <h3><?= getLocalizedText("student") ?></h3>
        <? for (var i = 0; i < students.length; i++) { ?>
          <div class="formItem">
            <input type="checkbox" id="student<?= i ?>" name="student" value="<?= students[i].email ?>" />
            <label for="student<?= i ?>"><?= students[i].name ?></label>
          </div>
          </tr>
        <? } ?>
      </div>
      <div>
        <h3><?= getLocalizedText("questionBank") ?></h3>
        <? for (var i = 0; i < questionBanks.length; i++) { ?>
          <div class="formItem">
            <input type="checkbox" id="questionBanks<?= i ?>" name="questionBanks" value="<?= questionBanks[i].name ?>" />
            <label for="questionBanks<?= i ?>"><?= questionBanks[i].name ?></label>
          </div>
          </tr>
        <? } ?>
      </div>
      <div>
        <input class="green" type="submit" value="<?= getLocalizedText("createNew") ?>" />
      </div>
    </form>
    <script>
      var submitForm = function (event) {
        event.preventDefault();
        var form = document.getElementById("formId");
        var formData = {};
        for (e of form.elements) {
          console.log(e.name, e.value);
          if (formData[e.name]==undefined) {
            formData[e.name] = e.value;
          } else if (Array.isArray(formData[e.name])) {
            formData[e.name].push(e.value);
          } else {
            formData[e.name] = [formData[e.name], e.value];
          }
        }
        google.script.run.withSuccessHandler(google.script.host.close).insertTest(formData);
      };

      document.getElementById("formId").addEventListener("submit", submitForm, false);
    </script>
  </body>
</html>
